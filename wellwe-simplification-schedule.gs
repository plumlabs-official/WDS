/**
 * WellWe 프로덕트 디자인 간소화 TF 일정표 자동 생성
 *
 * 사용법:
 * 1. Google 스프레드시트 새로 만들기
 * 2. 확장 프로그램 > Apps Script
 * 3. 이 코드 전체 복사 붙여넣기
 * 4. 저장 후 실행 (createScheduleSheet 함수)
 * 5. 권한 승인
 */

// 전체 데이터 정의
const SCHEDULE_DATA = [
  // [대분류, 중분류, 소분류, 상태, 세션, 데드라인, 우선순위, 비고]

  // 1. 사전 진입
  ["1. 사전 진입", "1.1 온보딩", "스플래시 화면", "미완료", "1차", "2026-02-27", "P0", "브랜드 인식 + 로딩"],
  ["1. 사전 진입", "1.1 온보딩", "가치 제안 슬라이드 (3장)", "미완료", "1차", "2026-02-27", "P0", "문제-솔루션-차별점"],
  ["1. 사전 진입", "1.1 온보딩", "초대 링크 진입 분기 처리", "미완료", "1차", "2026-02-27", "P0", "초대 맥락 강조"],
  ["1. 사전 진입", "1.1 온보딩", "퀵 서베이 (3문항)", "미완료", "1차", "2026-02-27", "P0", "목표/기간/함께할 대상"],
  ["1. 사전 진입", "1.2 계정/인증", "소셜 로그인 (Apple/Google/카카오)", "미완료", "1차", "2026-02-27", "P0", "소셜 우선 노출"],
  ["1. 사전 진입", "1.2 계정/인증", "이메일 가입", "미완료", "1차", "2026-02-27", "P1", ""],
  ["1. 사전 진입", "1.2 계정/인증", "연락처 동기화 요청", "미완료", "1차", "2026-02-27", "P0", "친구 찾기 유도"],
  ["1. 사전 진입", "1.2 계정/인증", "퍼미션 요청 (알림/카메라/사진)", "미완료", "1차", "2026-02-27", "P0", "Just-in-Time"],
  ["1. 사전 진입", "1.3 첫 챌린지 추천", "개인화 추천 로직", "미완료", "1차", "2026-02-27", "P0", "퀵서베이 기반"],
  ["1. 사전 진입", "1.3 첫 챌린지 추천", "무료 챌린지 우선 노출", "미완료", "1차", "2026-02-27", "P0", "첫 결제 장벽 제거"],
  ["1. 사전 진입", "1.3 첫 챌린지 추천", "친구와 함께 유도 UI", "미완료", "1차", "2026-02-27", "P1", "완주율 2배 강조"],

  // 2. 홈/탐색
  ["2. 홈/탐색", "2.1 홈탭", "챌린지 추천 섹션", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.1 홈탭", "개인화 추천 피드", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.1 홈탭", "진행중 챌린지 빠른 접근", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.2 마켓/검색", "챌린지 검색", "미완료", "4차", "2026-04-10", "P2", "탐색 효율"],
  ["2. 홈/탐색", "2.2 마켓/검색", "카테고리 필터", "미완료", "4차", "2026-04-10", "P2", ""],
  ["2. 홈/탐색", "2.2 마켓/검색", "정렬 (인기순/최신순/완주율)", "미완료", "4차", "2026-04-10", "P2", ""],
  ["2. 홈/탐색", "2.2 마켓/검색", "크리에이터 검색", "미완료", "4차", "2026-04-10", "P2", ""],
  ["2. 홈/탐색", "2.3 챌린지 상세", "챌린지 정보 (기간/가격/크리에이터)", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.3 챌린지 상세", "일일 할 일 미리보기", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.3 챌린지 상세", "참여 CTA (결제 분기)", "완료", "-", "-", "-", "간소화 완료"],
  ["2. 홈/탐색", "2.3 챌린지 상세", "리뷰/후기 섹션", "미완료", "4차", "2026-04-10", "P2", ""],

  // 3. 챌린지 참여
  ["3. 챌린지 참여", "3.1 챌린지 방 생성", "시작일 설정", "완료", "-", "-", "-", "초대 플로우 완료"],
  ["3. 챌린지 참여", "3.1 챌린지 방 생성", "멤버 초대", "완료", "-", "-", "-", "초대 플로우 완료"],
  ["3. 챌린지 참여", "3.1 챌린지 방 생성", "결제 방식 선택", "완료", "-", "-", "-", "초대 플로우 완료"],
  ["3. 챌린지 참여", "3.1 챌린지 방 생성", "초대 링크 생성/공유", "완료", "-", "-", "-", "초대 플로우 완료"],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "체험 가능 여부 분기", "미완료", "3차", "2026-03-27", "P1", "수익화 핵심"],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "참여 확인 팝업 UX", "미완료", "3차", "2026-03-27", "P1", ""],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "2일 무료 체험 플로우", "미완료", "3차", "2026-03-27", "P1", ""],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "결제 요청 화면", "미완료", "3차", "2026-03-27", "P1", ""],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "결제 성공/실패 처리", "미완료", "3차", "2026-03-27", "P1", ""],
  ["3. 챌린지 참여", "3.2 참여 확인/결제", "가입 축하 크레딧 적용", "미완료", "3차", "2026-03-27", "P1", "$5 웰컴 크레딧"],
  ["3. 챌린지 참여", "3.3 대기 기간", "D-day 카운트다운", "미완료", "2차", "2026-03-13", "P1", ""],
  ["3. 챌린지 참여", "3.3 대기 기간", "한줄 다짐 작성", "미완료", "2차", "2026-03-13", "P2", ""],

  // 4. 챌린지 방
  ["4. 챌린지 방", "4.1 인증 탭", "오늘의 할 일 표시", "완료", "-", "-", "-", "간소화 완료"],
  ["4. 챌린지 방", "4.1 인증 탭", "Day 진행 표시", "미완료", "2차", "2026-03-13", "P0", ""],
  ["4. 챌린지 방", "4.1 인증 탭", "그룹 완주율 표시", "미완료", "2차", "2026-03-13", "P0", ""],
  ["4. 챌린지 방", "4.1 인증 탭", "인증 피드 (사진+글)", "미완료", "1차", "2026-02-27", "P0", ""],
  ["4. 챌린지 방", "4.1 인증 탭", "인증 작성 UI", "미완료", "1차", "2026-02-27", "P0", ""],
  ["4. 챌린지 방", "4.1 인증 탭", "응원 보내기 (넛지)", "미완료", "2차", "2026-03-13", "P1", ""],
  ["4. 챌린지 방", "4.1 인증 탭", "크리에이터 카드", "미완료", "2차", "2026-03-13", "P1", "자동 메시지"],
  ["4. 챌린지 방", "4.2 채팅 탭", "멤버 간 대화", "미완료", "3차", "2026-03-27", "P1", ""],
  ["4. 챌린지 방", "4.2 채팅 탭", "시스템 메시지", "미완료", "3차", "2026-03-27", "P1", ""],
  ["4. 챌린지 방", "4.2 채팅 탭", "공지 등록 (방장)", "미완료", "3차", "2026-03-27", "P2", ""],
  ["4. 챌린지 방", "4.3 멤버 탭", "멤버 목록", "미완료", "2차", "2026-03-13", "P1", ""],
  ["4. 챌린지 방", "4.3 멤버 탭", "개인별 통계", "미완료", "2차", "2026-03-13", "P1", ""],

  // 5. 할 일
  ["5. 할 일", "5.1 진행중 챌린지", "진행중 챌린지 목록", "부분완료", "-", "-", "-", "큰 틀 완료"],
  ["5. 할 일", "5.1 진행중 챌린지", "챌린지별 진행률", "미완료", "4차", "2026-04-10", "P2", "세부 디자인"],
  ["5. 할 일", "5.2 미션", "오늘 미션 목록", "완료", "-", "-", "-", "간소화 완료"],
  ["5. 할 일", "5.3 리그", "리더보드", "부분완료", "-", "-", "-", "큰 틀 완료"],
  ["5. 할 일", "5.4 종료된 챌린지", "완주/미완주 기록", "부분완료", "-", "-", "-", "큰 틀 완료"],

  // 6. 피드/소셜
  ["6. 피드/소셜", "6.1 피드 탭", "지인 인증 피드", "완료", "-", "-", "-", "피드 탭 완료"],
  ["6. 피드/소셜", "6.1 피드 탭", "좋아요/댓글/공유", "미완료", "2차", "2026-03-13", "P1", "세부 인터랙션"],
  ["6. 피드/소셜", "6.2 라운지", "라운지 메뉴 구성", "부분완료", "-", "-", "-", "메뉴만 완료"],
  ["6. 피드/소셜", "6.2 라운지", "라운지 입장 조건", "미완료", "2차", "2026-03-13", "P0", "입장 정책 결정 (유료 챌린지 전용 라운지 포함)"],
  ["6. 피드/소셜", "6.2 라운지", "크리에이터 소통", "미완료", "2차", "2026-03-13", "P0", ""],
  ["6. 피드/소셜", "6.2 라운지", "참여자 교류", "미완료", "2차", "2026-03-13", "P1", ""],
  ["6. 피드/소셜", "6.2 라운지", "라운지 공지", "미완료", "2차", "2026-03-13", "P2", ""],

  // 7. 완주/보상
  ["7. 완주/보상", "7.1 완주 플로우", "완주 축하 메시지", "미완료", "4차", "2026-04-10", "P1", "리텐션 핵심"],
  ["7. 완주/보상", "7.1 완주 플로우", "완주 연출", "미완료", "4차", "2026-04-10", "P2", ""],
  ["7. 완주/보상", "7.2 수료증", "수료증 발급 화면", "미완료", "4차", "2026-04-10", "P1", ""],
  ["7. 완주/보상", "7.2 수료증", "SNS 공유", "미완료", "4차", "2026-04-10", "P1", "바이럴"],
  ["7. 완주/보상", "7.3 재참여 유도", "다음 챌린지 추천", "미완료", "4차", "2026-04-10", "P1", ""],

  // 8. 프로필
  ["8. 프로필", "8.1 기본", "프로필 이미지/닉네임", "미완료", "4차", "2026-04-10", "P2", ""],
  ["8. 프로필", "8.1 기본", "활동점수 노출 간소화 정책", "미완료", "4차", "2026-04-10", "P1", "간소화 주제e: 한 곳에만 표시"],
  ["8. 프로필", "8.2 피드 히스토리", "내 인증 피드 목록", "완료", "-", "-", "-", "간소화 완료"],
  ["8. 프로필", "8.3 업적", "획득 배지 목록", "부분완료", "-", "-", "-", "1depth 완료"],
  ["8. 프로필", "8.3 업적", "배지 상세/조건", "미완료", "4차", "2026-04-10", "P2", ""],
  ["8. 프로필", "8.3 업적", "최고기록 섹션 제거 결정", "미완료", "4차", "2026-04-10", "P1", "간소화 주제f: 최고기록 제거"],
  ["8. 프로필", "8.4 챌린지 기록", "참여/완주 이력", "미완료", "4차", "2026-04-10", "P2", ""],

  // 9. 크리에이터
  ["9. 크리에이터", "9.1 챌린지 만들기", "기본 정보 설정", "완료", "-", "-", "-", "챌린지 만들기 완료"],
  ["9. 크리에이터", "9.1 챌린지 만들기", "기간/인원 설정", "완료", "-", "-", "-", "챌린지 만들기 완료"],
  ["9. 크리에이터", "9.1 챌린지 만들기", "일일 할 일 설정", "완료", "-", "-", "-", "챌린지 만들기 완료"],
  ["9. 크리에이터", "9.1 챌린지 만들기", "카테고리/공개/가격 설정", "완료", "-", "-", "-", "챌린지 만들기 완료"],
  ["9. 크리에이터", "9.2 자동 코칭", "자동 메시지 템플릿", "미완료", "4차", "2026-04-10", "P2", ""],
  ["9. 크리에이터", "9.3 라이브 메시지", "라이브 메시지 작성", "미완료", "4차", "2026-04-10", "P2", "유료 전용"],
  ["9. 크리에이터", "9.3 라이브 메시지", "크리에이터 푸시 발송 정책", "미완료", "4차", "2026-04-10", "P1", "간소화 주제h: 푸시 발송 권한/정책"],
  ["9. 크리에이터", "9.3 라이브 메시지", "크리에이터 어드민 푸시 UI", "미완료", "4차", "2026-04-10", "P2", "간소화 주제h: 앱 내 발송 화면"],
  ["9. 크리에이터", "9.4 대시보드", "참여자 현황 모니터링", "미완료", "4차", "2026-04-10", "P2", ""],

  // 10. 알림
  ["10. 알림", "10.1 푸시 알림", "일일 할 일 안내 푸시", "미완료", "4차", "2026-04-10", "P1", "인게이지먼트"],
  ["10. 알림", "10.1 푸시 알림", "미인증 리마인더", "미완료", "4차", "2026-04-10", "P1", ""],
  ["10. 알림", "10.2 인앱 알림", "알림 센터/목록", "미완료", "4차", "2026-04-10", "P2", ""],
  ["10. 알림", "10.3 알림 설정", "카테고리별 ON/OFF", "미완료", "4차", "2026-04-10", "P2", ""],

  // 11. 설정
  ["11. 설정", "11.1 앱 설정", "알림 설정", "미완료", "4차", "2026-04-10", "P2", ""],
  ["11. 설정", "11.2 계정 관리", "프로필 수정", "미완료", "4차", "2026-04-10", "P2", ""],
  ["11. 설정", "11.2 계정 관리", "로그아웃", "미완료", "4차", "2026-04-10", "P2", ""],
  ["11. 설정", "11.2 계정 관리", "회원 탈퇴", "미완료", "4차", "2026-04-10", "P2", ""],
  ["11. 설정", "11.3 결제/구매", "결제 수단 관리", "미완료", "3차", "2026-03-27", "P1", "결제 플로우"],
  ["11. 설정", "11.3 결제/구매", "크레딧 충전", "미완료", "3차", "2026-03-27", "P1", ""],
  ["11. 설정", "11.4 고객 지원", "FAQ", "미완료", "4차", "2026-04-10", "P2", ""],

  // 12. 게이미피케이션
  ["12. 게이미피케이션", "12.1 연속 인증", "연속 인증 표시", "미완료", "4차", "2026-04-10", "P2", ""],
  ["12. 게이미피케이션", "12.2 활동점수", "활동점수 획득/누적", "미완료", "4차", "2026-04-10", "P2", ""],
  ["12. 게이미피케이션", "12.3 배지", "배지 획득 연출", "미완료", "4차", "2026-04-10", "P2", ""],
  ["12. 게이미피케이션", "12.4 리더보드", "챌린지 방 내 리더보드", "미완료", "4차", "2026-04-10", "P2", ""]
];

// 세션별 정보
const SESSION_INFO = [
  { name: "1차", date: "2026-02-27", theme: "신규 유저 진입", color: "#E3F2FD" },
  { name: "2차", date: "2026-03-13", theme: "핵심 사용 경험", color: "#E8F5E9" },
  { name: "3차", date: "2026-03-27", theme: "수익화/리텐션", color: "#FFF3E0" },
  { name: "4차", date: "2026-04-10", theme: "마무리/QA", color: "#FCE4EC" }
];

/**
 * 메인 함수 - 일정표 시트 생성
 */
function createScheduleSheet() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();

  // 기존 시트 삭제 (있으면)
  let existingSheet = ss.getSheetByName("간소화 일정표");
  if (existingSheet) {
    ss.deleteSheet(existingSheet);
  }

  // 새 시트 생성
  const sheet = ss.insertSheet("간소화 일정표");

  // 헤더 설정
  const headers = ["대분류", "중분류", "소분류", "상태", "세션", "데드라인", "우선순위", "비고"];
  sheet.getRange(1, 1, 1, headers.length).setValues([headers]);

  // 헤더 스타일
  sheet.getRange(1, 1, 1, headers.length)
    .setBackground("#1565C0")
    .setFontColor("white")
    .setFontWeight("bold")
    .setHorizontalAlignment("center");

  // 데이터 입력
  sheet.getRange(2, 1, SCHEDULE_DATA.length, headers.length).setValues(SCHEDULE_DATA);

  // 상태별 조건부 서식
  applyConditionalFormatting(sheet, SCHEDULE_DATA.length);

  // 열 너비 조정
  sheet.setColumnWidth(1, 120); // 대분류
  sheet.setColumnWidth(2, 140); // 중분류
  sheet.setColumnWidth(3, 200); // 소분류
  sheet.setColumnWidth(4, 80);  // 상태
  sheet.setColumnWidth(5, 60);  // 세션
  sheet.setColumnWidth(6, 100); // 데드라인
  sheet.setColumnWidth(7, 70);  // 우선순위
  sheet.setColumnWidth(8, 150); // 비고

  // 필터 설정
  sheet.getRange(1, 1, SCHEDULE_DATA.length + 1, headers.length).createFilter();

  // 틀 고정
  sheet.setFrozenRows(1);
  sheet.setFrozenColumns(3);

  // 요약 시트 생성
  createSummarySheet(ss);

  // 타임라인 시트 생성
  createTimelineSheet(ss);

  SpreadsheetApp.getUi().alert('일정표가 생성되었습니다!\n\n- 간소화 일정표: 전체 항목\n- 요약: 통계\n- 타임라인: 세션별 뷰');
}

/**
 * 조건부 서식 적용
 */
function applyConditionalFormatting(sheet, rowCount) {
  const statusRange = sheet.getRange(2, 4, rowCount, 1);

  // 완료 - 초록색
  const ruleComplete = SpreadsheetApp.newConditionalFormatRule()
    .whenTextEqualTo("완료")
    .setBackground("#C8E6C9")
    .setRanges([statusRange])
    .build();

  // 부분완료 - 노란색
  const rulePartial = SpreadsheetApp.newConditionalFormatRule()
    .whenTextEqualTo("부분완료")
    .setBackground("#FFF9C4")
    .setRanges([statusRange])
    .build();

  // 미완료 - 빨간색 (연한)
  const ruleIncomplete = SpreadsheetApp.newConditionalFormatRule()
    .whenTextEqualTo("미완료")
    .setBackground("#FFCDD2")
    .setRanges([statusRange])
    .build();

  // 규칙 적용
  const rules = sheet.getConditionalFormatRules();
  rules.push(ruleComplete);
  rules.push(rulePartial);
  rules.push(ruleIncomplete);
  sheet.setConditionalFormatRules(rules);
}

/**
 * 요약 시트 생성
 */
function createSummarySheet(ss) {
  let existingSheet = ss.getSheetByName("요약");
  if (existingSheet) {
    ss.deleteSheet(existingSheet);
  }

  const sheet = ss.insertSheet("요약");

  // 전체 요약
  const summaryData = [
    ["WellWe 프로덕트 디자인 간소화 TF 요약", "", "", ""],
    ["", "", "", ""],
    ["전체 현황", "", "", ""],
    ["상태", "항목 수", "비율", ""],
    ["완료", "=COUNTIF('간소화 일정표'!D:D,\"완료\")", "=B5/SUM(B5:B7)", ""],
    ["부분완료", "=COUNTIF('간소화 일정표'!D:D,\"부분완료\")", "=B6/SUM(B5:B7)", ""],
    ["미완료", "=COUNTIF('간소화 일정표'!D:D,\"미완료\")", "=B7/SUM(B5:B7)", ""],
    ["", "", "", ""],
    ["세션별 일정", "", "", ""],
    ["세션", "날짜", "테마", "항목 수"],
    ["1차", "2026-02-27 (금)", "신규 유저 진입", "=COUNTIF('간소화 일정표'!E:E,\"1차\")"],
    ["2차", "2026-03-13 (금)", "핵심 사용 경험", "=COUNTIF('간소화 일정표'!E:E,\"2차\")"],
    ["3차", "2026-03-27 (금)", "수익화/리텐션", "=COUNTIF('간소화 일정표'!E:E,\"3차\")"],
    ["4차", "2026-04-10 (금)", "마무리/QA", "=COUNTIF('간소화 일정표'!E:E,\"4차\")"],
    ["", "", "", ""],
    ["우선순위별", "", "", ""],
    ["우선순위", "항목 수", "", ""],
    ["P0 (필수)", "=COUNTIF('간소화 일정표'!G:G,\"P0\")", "", ""],
    ["P1 (중요)", "=COUNTIF('간소화 일정표'!G:G,\"P1\")", "", ""],
    ["P2 (권장)", "=COUNTIF('간소화 일정표'!G:G,\"P2\")", "", ""]
  ];

  sheet.getRange(1, 1, summaryData.length, 4).setValues(summaryData);

  // 스타일 적용
  sheet.getRange(1, 1, 1, 4).setFontSize(14).setFontWeight("bold");
  sheet.getRange(3, 1).setFontWeight("bold");
  sheet.getRange(4, 1, 1, 4).setBackground("#E3F2FD").setFontWeight("bold");
  sheet.getRange(9, 1).setFontWeight("bold");
  sheet.getRange(10, 1, 1, 4).setBackground("#E3F2FD").setFontWeight("bold");
  sheet.getRange(16, 1).setFontWeight("bold");
  sheet.getRange(17, 1, 1, 4).setBackground("#E3F2FD").setFontWeight("bold");

  // 퍼센트 형식
  sheet.getRange(5, 3, 3, 1).setNumberFormat("0%");

  // 열 너비
  sheet.setColumnWidth(1, 100);
  sheet.setColumnWidth(2, 150);
  sheet.setColumnWidth(3, 150);
  sheet.setColumnWidth(4, 100);
}

/**
 * 타임라인 시트 생성
 */
function createTimelineSheet(ss) {
  let existingSheet = ss.getSheetByName("타임라인");
  if (existingSheet) {
    ss.deleteSheet(existingSheet);
  }

  const sheet = ss.insertSheet("타임라인");

  // 타임라인 헤더
  const headers = [
    ["", "2월", "", "", "", "3월", "", "", "", "4월", "", ""],
    ["작업", "W1", "W2", "W3", "W4", "W1", "W2", "W3", "W4", "W1", "W2", "상태"]
  ];

  sheet.getRange(1, 1, 2, 12).setValues(headers);
  sheet.getRange(1, 1, 2, 12).setFontWeight("bold").setHorizontalAlignment("center");
  sheet.getRange(1, 1, 1, 12).setBackground("#1565C0").setFontColor("white");

  // 세션별 데이터 막대
  const timelineData = [
    ["1차: 온보딩/인증", "", "", "█", "█", "", "", "", "", "", "", "2/27"],
    ["2차: 라운지/챌린지방", "", "", "", "", "", "█", "█", "", "", "", "3/13"],
    ["3차: 결제/채팅", "", "", "", "", "", "", "", "█", "█", "", "3/27"],
    ["4차: 알림/설정/QA", "", "", "", "", "", "", "", "", "", "█", "4/10"]
  ];

  sheet.getRange(3, 1, timelineData.length, 12).setValues(timelineData);

  // 색상 적용
  sheet.getRange(3, 4, 1, 2).setBackground("#E3F2FD"); // 1차
  sheet.getRange(4, 7, 1, 2).setBackground("#E8F5E9"); // 2차
  sheet.getRange(5, 9, 1, 2).setBackground("#FFF3E0"); // 3차
  sheet.getRange(6, 11, 1, 1).setBackground("#FCE4EC"); // 4차

  // 열 너비
  sheet.setColumnWidth(1, 200);
  for (let i = 2; i <= 11; i++) {
    sheet.setColumnWidth(i, 40);
  }
  sheet.setColumnWidth(12, 80);

  // 범례
  const legendData = [
    ["", "", "", "", "", "", "", "", "", "", "", ""],
    ["범례:", "", "", "", "", "", "", "", "", "", "", ""],
    ["1차 워크샵", "█", "", "신규 유저 진입", "", "", "", "", "", "", "", ""],
    ["2차 워크샵", "█", "", "핵심 사용 경험", "", "", "", "", "", "", "", ""],
    ["3차 워크샵", "█", "", "수익화/리텐션", "", "", "", "", "", "", "", ""],
    ["4차 워크샵", "█", "", "마무리/QA", "", "", "", "", "", "", "", ""]
  ];

  sheet.getRange(8, 1, legendData.length, 12).setValues(legendData);
  sheet.getRange(9, 2).setBackground("#E3F2FD");
  sheet.getRange(10, 2).setBackground("#E8F5E9");
  sheet.getRange(11, 2).setBackground("#FFF3E0");
  sheet.getRange(12, 2).setBackground("#FCE4EC");
}

/**
 * 메뉴 추가
 */
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('WellWe TF')
    .addItem('일정표 생성', 'createScheduleSheet')
    .addItem('데이터 새로고침', 'refreshData')
    .addToUi();
}

/**
 * 데이터 새로고침
 */
function refreshData() {
  createScheduleSheet();
}
